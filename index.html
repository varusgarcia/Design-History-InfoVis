<html>
<head>
  <title>Design Geschichte InfoVis</title>
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <link rel="stylesheet" href="main.css">
</head>

<body>
  <nav>This is the Navigation</nav>

  <script>
      d3.json("https://raw.githubusercontent.com/varusgarcia/Design-History-InfoVis/master/test-db/data.json", function (data){

      var browserHeight = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
      var startDate = 1850;
      var xScale = 30;

      var canvas = d3.select("body")
                    .append("svg")
                    .attr("width", 5000)
                    .attr("height", browserHeight)

      // Define the data for the node groups
      var nodeElements = canvas.selectAll("node")
                    .data(data) // binds data to circles

      // Create and place the "blocks" containing the circle and the text
      var nodeBlock = nodeElements.enter()
                    .append("g")
                    .attr("id", function (d){ return d.ID})
                    .attr("transform", function(d) { return "translate("+((d.Geboren * xScale) - (startDate * xScale))+","+(Math.random() * (browserHeight-40 - 30) + 30)+")";})

      var circles = nodeBlock.append("circle")
                    .attr("r", 50)

      var labels = nodeBlock.append("text")
                    .attr("dx", function(d){ return -20 })
                    .attr("fill", "white")
                    .text(function(d){ return d.Name })

      d3.json("https://raw.githubusercontent.com/varusgarcia/Design-History-InfoVis/master/test-db/connection.json", function (connection){

        //var currentX = d3.transform(d3.select(this).attr("transform")).translate[0];

        //var g = d3.select("svg").selectAll("#id01")

        //var currentX = d3.transform(g.attr("transform")).translate[0]
        //var currentY = d3.transform(g.attr("transform")).translate[1]

        //g.attr("transform", "translate("+ (currentX + 100)+",0)")


        var line = canvas.selectAll("line")
                    .data(connection)
                    .enter()
                    .append("line")
                      .attr("x1", function (d){
                        var g = d3.select("svg").selectAll("#"+d.ID1)
                        var currentX = d3.transform(g.attr("transform")).translate[0]
                        return currentX
                      })
                      .attr("y1", function (d){
                        var g = d3.select("svg").selectAll("#"+d.ID1)
                        var currentY = d3.transform(g.attr("transform")).translate[1]
                        return currentY
                      })
                      .attr("x2", function (d){
                        var g = d3.select("svg").selectAll("#"+d.ID2)
                        var currentX = d3.transform(g.attr("transform")).translate[0]
                        return currentX
                      })
                      .attr("y2", function (d){
                        var g = d3.select("svg").selectAll("#"+d.ID2)
                        var currentY = d3.transform(g.attr("transform")).translate[1]
                        return currentY
                      })
                      .attr("stroke", "green")
                      .attr("stroke-width", 2);



      })

    })
  </script>
</body>
</html>
